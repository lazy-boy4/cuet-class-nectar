# Current Development Context - CUET ClassNectar

## Status: Backend Phase 2 - Hardening, File Uploads, RLS, Testing & Integration Prep

The initial phase of backend API development is complete, with core features for Admin, Teacher, and Student roles implemented. We are now moving into Phase 2, which focuses on critical supporting features, security, testing, and preparing for frontend integration.

## Recently Completed (End of Backend Phase 1)
- ✅ **Admin Features**: CRUD for Departments, Courses, Classes; User Profile Management (with auth limitations); Bulk Student Profile Upload (profiles only); Teacher Assignments; Promote/Demote CRs.
- ✅ **Teacher Features**: Notice Management; Attendance Tracking; Structured Schedule Management; Teacher Dashboard data endpoint.
- ✅ **Student & CR Features**: Student Dashboard data; Student Profile Management; Enrollment Requests (student & CR review); CR Class Event Management.
- ✅ **Core**: Auth (Signup, Login, JWT Middleware), Role-based middleware (Admin, Teacher, CR).
- ✅ **RLS Policy Generation**: SQL script for comprehensive RLS policies has been generated (pending manual application & testing).

## Current Focus: Updating Memory Bank
- **Current Task**: Updating all memory bank documents (`progress.md`, `activeContext.md`, `productContext.md`, `systemPatterns.md`, `techContext.md`) to reflect the project's current state accurately.
  - `progress.md` has been updated.
  - `activeContext.md` is being updated now.

## Next Immediate Steps (Following Memory Bank Update)
1.  **Implement File Uploads (with workarounds for library issues)**:
    *   **CR PDF Routine Uploads**: Design API and service. Implement with stubbed storage if `nedpals/supabase-go` storage issues persist.
    *   **Profile Picture Uploads**: Revisit existing stubbed implementation. Confirm dummy URL flow or attempt fix if new library info is available.
    *   This might involve investigating alternative ways to interact with Supabase storage if the Go client remains problematic (e.g. pre-signed URLs generated by backend, client uploads direct to storage).

2.  **Apply and Test RLS Policies**:
    *   User (manual step) to apply the generated `rls_policies.sql` script to the Supabase database.
    *   Backend developer (Jules/Void) to assist in testing RLS by attempting various operations as different user roles via API calls.

3.  **Backend API Testing**:
    *   Begin writing unit tests for critical service functions.
    *   Plan and start integration testing for API endpoints.

## Key Considerations & Challenges
- **Supabase Go Library (`nedpals/supabase-go@v0.5.0`) Limitations**:
    - **Admin Auth**: No support for admin creation/deletion of `auth.users` (these are manual operations for now).
    - **Storage API**: Persistent build/runtime errors with Storage methods led to stubbing file uploads (returns dummy URLs). This is a major item to address or find a workaround for.
    - **Query Ordering**: `.Order()` method caused build issues; removed from some list queries.
- **Manual Steps**: RLS policy application is a manual step for the user.
- **Frontend Integration**: Will require close collaboration and potentially API adjustments.

This context will guide the subsequent tasks in Phase 2.
